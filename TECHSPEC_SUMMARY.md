# Style License 기술 명세 요약 (TECHSPEC_SUMMARY.md)

이 문서는 Style License 프로젝트의 핵심 기술 명세와 아키텍처를 요약하여 AI 에이전트 및 신규 참여자가 프로젝트의 전체 구조를 빠르게 파악할 수 있도록 돕는 것을 목표로 합니다.

---

## 1. 프로젝트 핵심 정체성

- **프로젝트명**: Style License
- **목적**: AI 기반 화풍 라이선싱 및 2차 창작 플랫폼. 작가가 자신의 화풍(Style)을 등록하면, 사용자는 라이선스를 구매하여 해당 화풍으로 2차 창작물을 생성하고 상업적으로 이용할 수 있습니다.
- **핵심 가치**: 작가의 화풍에 대한 저작권을 명확히 보호하고, 합법적이고 투명한 AI 창작 생태계를 구축합니다.
- **해결 문제**: AI 이미지 생성 시 발생하는 원작자의 저작권 침해 문제를 해결하고, 작가에게 새로운 수익 창출 기회를 제공합니다.

---

## 2. 아키텍처 및 기술 스택

### 2.1. 전체 시스템 구조

본 프로젝트는 다음과 같은 주요 컴포넌트로 구성된 Monorepo 기반의 MSA(Microservice Architecture) 구조를 가집니다.

```
┌──────────┐      ┌───────────┐      ┌────────────────┐
│          │      │           │      │                │
│ Frontend ├─────►│  Backend  ├─────►│ Message Queue  │
│ (Vue.js) │      │ (Django)  │      │  (RabbitMQ)    │
│          │      │           │      │                │
└──────────┘      └─────┬─────┘      └──────┬─────────┘
                        │                   │
                        │                   │
              ┌─────────▼─────────┐  ┌──────▼─────────┐
              │                   │  │                │
              │    Database       │  │   AI Servers   │
              │   (PostgreSQL)    │  │ (Training/Infer)
              │                   │  │                │
              └───────────────────┘  └────────────────┘
```

- **Frontend**: 사용자와의 상호작용을 담당하는 Vue 3 기반의 싱글 페이지 애플리케이션(SPA)입니다.
- **Backend**: Django 기반의 REST API 서버로, 비즈니스 로직, 인증, 데이터 관리를 총괄합니다.
- **AI Servers**:
    - **Training Server**: 작가가 업로드한 이미지로 LoRA 모델을 학습(Fine-tuning)합니다.
    - **Inference Server**: 학습된 모델을 사용하여 사용자 요청에 따라 이미지를 생성합니다.
- **Message Queue**: RabbitMQ를 사용하여 Backend와 AI 서버 간의 비동기 작업을 안정적으로 처리합니다. (모델 학습, 이미지 생성)
- **Database**: PostgreSQL을 사용하여 모든 데이터를 관리합니다.

### 2.2. 핵심 기술 스택

| 구분 | 기술 | 선정 이유 |
|---|---|---|
| **Frontend** | Vue 3 (JavaScript) | 낮은 러닝 커브, Composition API의 유연성, 빠른 프로토타이핑. |
| **Backend** | Django | Python AI/ML 생태계와 통합이 용이하며, Admin 패널을 기본 제공. |
| **Database** | PostgreSQL | ACID 보장, 복잡한 관계형 데이터 및 JSON 필드 지원. |
| **Message Queue** | RabbitMQ | 장시간 소요되는 AI 작업을 안정적으로 비동기 처리. |
| **AI Model** | Stable Diffusion (LoRA) | 오픈소스이며, LoRA Fine-tuning을 지원하여 효율적인 모델 학습 가능. |
| **Infra** | Docker, GCP | 개발/운영 환경 일관성을 유지하고, GPU 서버를 유연하게 관리. |

### 2.3. 주요 데이터 흐름

- **모델 학습**: 작가 이미지 업로드 → Backend가 검증 후 RabbitMQ에 작업 전송 → Training Server가 모델 학습 후 Cloud Storage에 저장.
- **이미지 생성**: 사용자 프롬프트 입력 → Backend가 토큰 차감 후 RabbitMQ에 작업 전송 → Inference Server가 이미지 생성 후 Cloud Storage에 저장.

---

## 3. 핵심 비즈니스 로직 및 규칙

### 3.1. 화풍(Style) 생성
- **작가당 1개 스타일**: MVP 단계에서는 작가 1명당 1개의 스타일만 생성할 수 있습니다.
- **학습 이미지**: 최소 10장, 최대 100장의 이미지가 필요합니다. (JPG, PNG, 512x512px 이상)
- **태그**: 모든 태그는 **영어**로만 입력해야 합니다. 스타일 이름은 자동으로 태그에 포함됩니다.
- **수정 불가**: 학습이 완료된 모델(스타일)은 작가가 임의로 삭제할 수 없습니다.

### 3.2. 이미지 생성
- **토큰 기반**: 이미지 생성 시 각 스타일별로 작가가 설정한 토큰이 차감됩니다.
- **프롬프트**: 태그 기반의 **영어** 키워드로 프롬프트를 작성해야 합니다.
- **작가 서명**: 생성된 모든 이미지에는 원작자(화풍 작가)의 서명이 자동으로 삽입되며, 제거할 수 없습니다.
- **소유권**: 생성된 이미지의 소유권은 생성한 사용자에게 있으며, 마이페이지에서 관리됩니다.

### 3.3. 토큰 시스템
- **웰컴 토큰**: 신규 가입 시 100 토큰이 무료로 지급됩니다.
- **토큰 구매**: 서버에 정의된 패키지 단위(예: 100, 500, 1000 토큰)로 구매할 수 있습니다.
- **가격 설정**: 작가는 자신의 스타일에 대해 '이미지 1장당 생성 비용'을 직접 설정합니다.
- **실패 시 환불**: 이미지 생성 실패 시, 소모된 토큰은 자동으로 환불됩니다.

### 3.4. 저작권 보호
- **서명 강제 삽입**: 모든 생성물에 작가 서명을 삽입하여 원작자를 명시합니다.
- **메타데이터**: 생성된 이미지 파일에 작가 정보, 스타일 ID 등 저작권 관련 정보를 기록합니다.
- **삭제 불가 정책**: 다른 사용자가 사용한 스타일을 만든 작가는 탈퇴할 수 없으며, 계정이 비활성화 처리됩니다. (생성물의 저작권 추적을 위함)

### 3.5. 인증 및 권한
- **Google OAuth**: 인증은 Google 소셜 로그인을 통해서만 이루어집니다.
- **권한**: 모든 사용자는 'user' 권한으로 가입하며, 별도 신청을 통해 'artist' 권한을 얻을 수 있습니다.

### 3.6. 주요 MVP 제외 기능
- **정산 시스템**: 작가가 번 토큰을 현금으로 환전하는 기능은 포함되지 않습니다.
- **고급 커뮤니티**: 작가 랭킹, 추천 시스템, 이미지 신고 기능 등은 제외됩니다.
- **알림 고도화**: 실시간 푸시 알림, 이메일 알림은 제외됩니다. (웹 내 알림만 제공)

---

## 4. 개발 가이드 및 상세 문서 링크

### 4.1. Monorepo 코드 구조

프로젝트 코드는 `apps` 디렉터리 내에 각 서버별로 나뉘어 관리됩니다.

- `apps/backend/`: Django API 서버 코드
- `apps/frontend/`: Vue.js 프론트엔드 코드
- `apps/training-server/`: 모델 학습 서버 코드
- `apps/inference-server/`: 이미지 생성(추론) 서버 코드

각 디렉터리에는 자체적인 `README.md`와 `CODE_GUIDE.md`가 있어 해당 애플리케이션의 상세한 아키텍처와 코드 스타일을 확인할 수 있습니다.

### 4.2. 로컬 개발 환경

프로젝트 루트의 `docker-compose.yml` 파일을 사용하여 모든 서비스를 로컬 환경에서 한 번에 실행할 수 있습니다.

```bash
# 프로젝트 루트 디렉터리에서 실행
docker-compose up -d
```

상세 설정은 루트의 `DOCKER.md` 문서를 참고하세요.

### 4.3. 상세 문서 링크

더 상세한 정보가 필요할 경우 다음 문서를 참조하세요.

- **[전체 기술 명세 (원본)](./TECHSPEC.md)**: 이 요약 문서의 원본이 되는 전체 기술 명세서입니다.
- **[전체 API 명세](./docs/API.md)**: 모든 API 엔드포인트, 요청/응답 형식, 에러 코드를 상세히 정의합니다.
- **[데이터베이스 설계](./docs/database/README.md)**: 전체 ERD, 테이블 스키마, 설계 원칙을 포함합니다.
- **[공통 코드 패턴](./docs/PATTERNS.md)**: API 응답 형식, RabbitMQ 메시지 포맷 등 공통 패턴을 정의합니다.
- **각 애플리케이션별 `README.md`**: `apps/*/README.md`에서 각 서버의 아키텍처와 배포 방법을 확인할 수 있습니다.
